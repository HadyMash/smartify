!#/bin/bash

# Called by "git commit" with no arguments.  The hook should
# exit with non-zero status after issuing an appropriate message if
# it wants to stop the commit.

# Format all files
# api
# TODO: check eslint for errors
prettier ./api --write --ignore-path .gitignore --log-level warn --ignore-unknown
prettier_exit_code=$?

if [ $prettier_exit_code -ne 0 ]; then
  echo "❌ Error formatting files in api server. Please fix any issues"
fi

# mobile app
dart analyze ./app
dart_analyze_exit_code=$?

if [ $dart_analyze_exit_code -ne 0 ]; then
  echo "❌ Error formatting files in the app. Please fix any issues first"
fi

dart format ./app
